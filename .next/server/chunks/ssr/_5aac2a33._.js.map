{"version":3,"sources":["turbopack:///[project]/node_modules/@tanstack/react-query/src/HydrationBoundary.tsx","turbopack:///[project]/src/app/features/block/profile-block/prifile-block.component.tsx"],"sourcesContent":["'use client'\nimport * as React from 'react'\n\nimport { hydrate } from '@tanstack/query-core'\nimport { useQueryClient } from './QueryClientProvider'\nimport type {\n  DehydratedState,\n  HydrateOptions,\n  OmitKeyof,\n  QueryClient,\n} from '@tanstack/query-core'\n\nexport interface HydrationBoundaryProps {\n  state: DehydratedState | null | undefined\n  options?: OmitKeyof<HydrateOptions, 'defaultOptions'> & {\n    defaultOptions?: OmitKeyof<\n      Exclude<HydrateOptions['defaultOptions'], undefined>,\n      'mutations'\n    >\n  }\n  children?: React.ReactNode\n  queryClient?: QueryClient\n}\n\nexport const HydrationBoundary = ({\n  children,\n  options = {},\n  state,\n  queryClient,\n}: HydrationBoundaryProps) => {\n  const client = useQueryClient(queryClient)\n\n  const optionsRef = React.useRef(options)\n  React.useEffect(() => {\n    optionsRef.current = options\n  })\n\n  // This useMemo is for performance reasons only, everything inside it must\n  // be safe to run in every render and code here should be read as \"in render\".\n  //\n  // This code needs to happen during the render phase, because after initial\n  // SSR, hydration needs to happen _before_ children render. Also, if hydrating\n  // during a transition, we want to hydrate as much as is safe in render so\n  // we can prerender as much as possible.\n  //\n  // For any queries that already exist in the cache, we want to hold back on\n  // hydrating until _after_ the render phase. The reason for this is that during\n  // transitions, we don't want the existing queries and observers to update to\n  // the new data on the current page, only _after_ the transition is committed.\n  // If the transition is aborted, we will have hydrated any _new_ queries, but\n  // we throw away the fresh data for any existing ones to avoid unexpectedly\n  // updating the UI.\n  const hydrationQueue: DehydratedState['queries'] | undefined =\n    React.useMemo(() => {\n      if (state) {\n        if (typeof state !== 'object') {\n          return\n        }\n\n        const queryCache = client.getQueryCache()\n        // State is supplied from the outside and we might as well fail\n        // gracefully if it has the wrong shape, so while we type `queries`\n        // as required, we still provide a fallback.\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        const queries = state.queries || []\n\n        const newQueries: DehydratedState['queries'] = []\n        const existingQueries: DehydratedState['queries'] = []\n        for (const dehydratedQuery of queries) {\n          const existingQuery = queryCache.get(dehydratedQuery.queryHash)\n\n          if (!existingQuery) {\n            newQueries.push(dehydratedQuery)\n          } else {\n            const hydrationIsNewer =\n              dehydratedQuery.state.dataUpdatedAt >\n                existingQuery.state.dataUpdatedAt ||\n              (dehydratedQuery.promise &&\n                existingQuery.state.status !== 'pending' &&\n                existingQuery.state.fetchStatus !== 'fetching' &&\n                dehydratedQuery.dehydratedAt !== undefined &&\n                dehydratedQuery.dehydratedAt >\n                  existingQuery.state.dataUpdatedAt)\n\n            if (hydrationIsNewer) {\n              existingQueries.push(dehydratedQuery)\n            }\n          }\n        }\n\n        if (newQueries.length > 0) {\n          // It's actually fine to call this with queries/state that already exists\n          // in the cache, or is older. hydrate() is idempotent for queries.\n          // eslint-disable-next-line react-hooks/refs\n          hydrate(client, { queries: newQueries }, optionsRef.current)\n        }\n        if (existingQueries.length > 0) {\n          return existingQueries\n        }\n      }\n      return undefined\n    }, [client, state])\n\n  React.useEffect(() => {\n    if (hydrationQueue) {\n      hydrate(client, { queries: hydrationQueue }, optionsRef.current)\n    }\n  }, [client, hydrationQueue])\n\n  return children as React.ReactElement\n}\n","'use client'\n\nimport { useUserQuery } from '@/app/entities/api/user'\nimport { type FC } from 'react'\n\n// interface\ninterface IProps {}\n\n// component\nconst ProfileBlockComponent: FC<Readonly<IProps>> = (props) => {\n  const { data: user, isLoading, error } = useUserQuery()\n\n  if (isLoading) {\n    return <div>Loading...</div>\n  }\n\n  if (error) {\n    return <div>Error: {error.message}</div>\n  }\n\n  if (!user) {\n    return <div>User not found</div>\n  }\n  // return\n  return (\n    <div className='mt-8 flex flex-col gap-6'>\n      <div className='bg-card rounded-lg border p-6 shadow'>\n        <h2 className='mb-2 text-lg font-semibold'>User Information</h2>\n        <div className='flex flex-col gap-1'>\n          <span className='text-muted-foreground text-sm'>Username: {user.name}</span>\n          <span className='text-muted-foreground text-sm'>Email: {user.email}</span>\n        </div>\n      </div>\n      <div className='bg-card rounded-lg border p-6 shadow'>\n        <h2 className='mb-2 text-lg font-semibold'>Account Settings</h2>\n        <ul className='text-muted-foreground list-disc space-y-1 pl-6 text-sm'>\n          <li>Change password</li>\n          <li>Edit profile</li>\n          <li>Manage notifications</li>\n        </ul>\n      </div>\n      <div className='bg-card rounded-lg border p-6 shadow'>\n        <h2 className='mb-2 text-lg font-semibold'>My Activity</h2>\n        <ul className='text-muted-foreground space-y-1 text-sm'>\n          <li>\n            Books added: <span className='font-medium'>12</span>\n          </li>\n          <li>\n            Reviews written: <span className='font-medium'>8</span>\n          </li>\n          <li>\n            Favorites: <span className='font-medium'>17</span>\n          </li>\n        </ul>\n      </div>\n    </div>\n  )\n}\n\nexport default ProfileBlockComponent\n"],"names":[],"mappings":"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"}